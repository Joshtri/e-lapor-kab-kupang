# ID Format Documentation

All entities in the database use prefixed IDs for easy identification and debugging.

## Format Structure

```
{prefix}_{timestamp}_{random}
```

- **prefix**: 3-character identifier for the entity type
- **timestamp**: Base36 encoded timestamp (shorter than decimal)
- **random**: 16-character hexadecimal random string

## Prefixes

| Model | Prefix | Example |
|-------|--------|---------|
| User | `usr` | `usr_m1n2o3p4q5_a1b2c3d4e5f6g7h8` |
| OPD | `opd` | `opd_m1n2o3p4q5_a1b2c3d4e5f6g7h8` |
| Report | `rep` | `rep_m1n2o3p4q5_a1b2c3d4e5f6g7h8` |
| Comment | `cmt` | `cmt_m1n2o3p4q5_a1b2c3d4e5f6g7h8` |
| Log | `log` | `log_m1n2o3p4q5_a1b2c3d4e5f6g7h8` |
| BugReport | `bug` | `bug_m1n2o3p4q5_a1b2c3d4e5f6g7h8` |
| BugComment | `bgc` | `bgc_m1n2o3p4q5_a1b2c3d4e5f6g7h8` |
| Notification | `ntf` | `ntf_m1n2o3p4q5_a1b2c3d4e5f6g7h8` |
| Email | `eml` | `eml_m1n2o3p4q5_a1b2c3d4e5f6g7h8` |
| ChatRoom | `crm` | `crm_m1n2o3p4q5_a1b2c3d4e5f6g7h8` |
| ChatMessage | `cmg` | `cmg_m1n2o3p4q5_a1b2c3d4e5f6g7h8` |

## Auto-Generation

IDs are automatically generated by Prisma middleware when creating new entities. You don't need to manually generate IDs.

```javascript
// IDs are auto-generated - no need to provide them
const user = await prisma.user.create({
  data: {
    // id is automatically generated as: usr_{timestamp}_{random}
    name: 'John Doe',
    email: 'john@example.com',
    // ... other fields
  }
});

console.log(user.id); // usr_m1n2o3p4q5_a1b2c3d4e5f6g7h8
```

## Manual Generation (Optional)

If you need to generate IDs manually (e.g., for testing), use the utility functions:

```javascript
import { generateUserId, generateOpdId, generateReportId } from '@/lib/generateId';

const userId = generateUserId(); // usr_m1n2o3p4q5_a1b2c3d4e5f6g7h8
const opdId = generateOpdId();   // opd_m1n2o3p4q5_a1b2c3d4e5f6g7h8
const reportId = generateReportId(); // rep_m1n2o3p4q5_a1b2c3d4e5f6g7h8
```

## Validation

Validate ID format using the provided validators:

```javascript
import { isValidUserId, isValidOpdId, isValidReportId } from '@/lib/generateId';

const userId = 'usr_m1n2o3p4q5_a1b2c3d4e5f6g7h8';
console.log(isValidUserId(userId)); // true

const badId = 'invalid-id';
console.log(isValidUserId(badId)); // false

// Check prefix from any ID
import { getIdPrefix } from '@/lib/generateId';
console.log(getIdPrefix(userId)); // 'usr'
```

## Benefits

1. **Easy Identification**: You can immediately tell what type of entity an ID belongs to
2. **Debugging**: When looking at logs or database queries, prefixes make it clear what you're working with
3. **Validation**: Prefix allows quick validation of ID types
4. **Uniqueness**: Combination of timestamp and random bytes ensures uniqueness
5. **Sortable**: Timestamp component allows chronological sorting

## Migration Notes

- Existing data with old ID format (integer or plain UUID) will continue to work
- New entities created after this change will have prefixed IDs
- The system handles both old and new ID formats transparently
